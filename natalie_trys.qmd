---
title: "natalie trys homework"
format: html
editor: visual
---

### Food Bank Markets

What do you predict would be the equilibrium price and quantity of peanut butter that would be traded?

Demand:

$P = 500 - 0.1Q$

Supply:

$P = 5 + 0.05Q$

Predicted eq price:

$5 + 0.05Q = 500 - 0.1Q$

$Q*$ = **3300 jars of peanut butter**

$P = 5 + 0.05(3300)$

$P*$ = **170 credits per jar**

What is the benefit of the new market to food banks that buy peanut butter? What is the benefit of the new market to food banks that sell peanut butter?

Calculate the consumer surplus and producer surplus by finding the area under the curve????

A very large new food bank in New York City enters the market, with an individual demand for peanut butter given by P = 400 - 2Q. Draw the new aggregate demand curve in this market. What is the new equilibrium price?

Original Demand:

$P = 500 - 0.1Q$

New Demand:

$P = 400 - 2Q$

Ag demand:

$P=(500 - 0.1Q)+(400 - 2Q)$

$P=-2Q +900$

New new equilibrium price:

$-2Q +900 =5 + 0.05Q$

$Q*$ = **436.59 jars of peanut butter**

$P*$ = **26.82 credits per jar**

Suppose that each jar of peanut butter that is traded generates carbon emissions due to fossil fuel intensive transport. This is called an “externality” and we will study them in detail throughout the course. Qualitatively, do you think this information should change the amount of peanut butter traded by food banks?

yes?

```{r}
# define the demand and supply functions
demand <- function(Q, a1, b1){
  P <- a1*Q + b1
  return(P)
}

supply <- function(Q, a2, b2){
  P <- a2*Q + b2
  return(P)
}

# find demand - supply
ds <- function(Q, a1, b1, a2, b2){
  a1 <- -0.1
  b1 <- 500
  a2 <- 0.05
  b2 <- 5
  Z <- fun1(Q, a1, b1) - fun2(Q, a2, b2)
  return(Z)
}

# use fzero to find the equilibrium price and quantity of peanut butter that would be traded
Q_star <- fzero(ds, c(0,5000))
P_star <- demand(Q_star[[1]], -0.1, 500)
print(c(Q_star[[1]], P_star))
```

The predicted equilibrium price of peanut butter is 170 credits per jar and the predicted equilibrium quantity is 3,300 jars.

b)  What is the benefit of the new market to food banks that buy peanut butter? What is the benefit of the new market to food banks that sell peanut butter?

COME BACK TO THIS !!!!!!!! The benefit of the new market to food banks that buy peanut butter

c)  A very large new food bank in New York City enters the market, with an individual demand for peanut butter given by P = 400 - 2Q. Draw the new aggregate demand curve in this market. What is the new equilibrium price?

```{r}
#flip the original demand function
flip_demand <- function(Q, a1, b1){
  P <- a1*Q + b1
  return(P)
}

# define the new demand function
new_demand <- function(Q, a3, b3){
  P <- a3*Q + b3
  return(P)
}

# make a data frame with the demand and aggregate demand functions
demand_df <- data.frame(Q = 0:500, flip_demand = flip_demand(0:500, -10, 5000), new_demand = new_demand(0:500,-.5, 200)) %>% 
    mutate(new_demand=case_when(Q>400~NA,
                              Q<=400~new_demand)) %>% 
  rowwise() %>% 
  mutate(ag_demand = sum(flip_demand,new_demand,na.rm=TRUE))

#plot demand_df
ggplot(demand_df, aes(y = Q))+
  geom_line(aes(x = flip_demand), color = "red") +
  geom_line(aes(x = new_demand), color = "blue") +
  geom_line(aes(x = ag_demand), color = "yellow") +
  labs(title = "Aggregate Demand for Peanut Butter",
       x = "Price (credits per jar)",
       y = "Quantity (jars)") +
  theme_minimal()
```

```{r}
# add the flipped demand functions to get an aggregate demand function
ag_demand <- function(Q, a1, b1, a3, b3){
  a1 <- -10
  b1 <- 5000
  a3 <- -.5
  b3 <- 200
  Z <- flip_demand(Q,a1, b1) + new_demand(Q, a3, b3)
  return(Z)
}

# difference between aggregate demand and supply
ag_s <- function(P, Q, a1, b1, a2, b2, a3, b3){
  a1 <- -10
  b1 <- 5000
  a2 <- 3
  b2 <- 0.2
  a3 <- -.5
  b3 <- 200
  Z <- ag_demand(Q, a1, b1, a3, b3) - supply(Q, a2, b2)
  return(Z)
}

# use fzero to find the new equilibrium price
P_star_new <- fzero(ag_demand, c(0,500))
Q_star_new <- supply(P_star_new[[1]], 0.05, 5)
```

a\) Using R to solve more complicated supply and demand problems: Old cars are often fuel inefficient. The supply of inefficient old cars on the used carmarket is given by: P = 200 + 0.2Q \^ 1.2 (where P is dollar/car and Q is the quantity of cars). The state of California offers a “cash for clunkers” program, where they will pay \$2,000 for any inefficient old car. Answer the following questions:

```{r}
### Write functions

car_supply <- function(Q) {
  P <-  200 + (0.2*(Q^1.2))
  return(P)
}

car_demand <- function(Q) {
  P <- 2000 - Q*0
  return(P)
}
```

i.  Use R to determine how many cars will be sold back to the state under this program (you can round to the nearest integer)

ii. Use R to calculate the elasticity of supply of inefficient cars, evaluated at the market equilibrium.

iii. What are the benefits of this policy to owners of old cars?

iv. What is the cost of this program to taxpayers (who fund the government

    payments)?

b\) Suppose the marginal benefit to society of removing old cars (this benefit comes from the environmental and health effects of removing fuel inefficient cars from the road) is given by: MB = 1000 – .01Q1.2 (where Q is the number of cars bought back under the program).

i\. Use R to find the socially optimal number of cars to remove (again, you can round to the nearest integer).

ii\. Use R to find the optimal “cash for clunkers” price (which may differ from the current price of \$2,000).
